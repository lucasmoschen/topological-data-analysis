\subsection{Important definitions}

\begin{definition}
    Let $i \in [[1, n]]$, and $d = dim(\sigma_i)$. The simplex $\sigma_i$ is
    positive if there exists a cycle $c \in Z_d(K^i$ ) that contains
    $\sigma_i$. Otherwise, $\sigma_i$ is negative.
\end{definition}

\begin{definition}
    Defines for a set $V = \{0,1,...,n\}$ a simplicial complex 
    $$
    \Delta_n = \{S \subset C, S \neq \emptyset\}
    $$
    and call it simplicial standard n-simplex with boundary 
    $$
    \partial \Delta_n = \Delta_n/V
    $$
\end{definition}

\begin{definition}
    Define the boundary matrix of $K$, denoted $\Delta$ as follows:
    $\Delta$ is a $n \times n$ matrix, whose 
    $$\Delta_{i,j} = \begin{cases}
    1, &\text{if }\sigma_i \subset \sigma_j \text{ and } |\sigma^i| =
    |\sigma^j| - 1 \\
    0, &\text{else} 
    \end{cases}$$
\end{definition}

\subsection{Exercise}

\begin{exercise}
    Compute again the Betti numbers of the simplicial complexes of Exercises 29 and 30, using the incremental algorithm.
\end{exercise}

\begin{proof}

\begin{enumerate}
    \item    $K = \{[0], [1], [2], [3], [0, 1], [1, 2], [2, 3], [3, 0]\}.$
    
    First we determine the ordering to be as placed in the set. It fulfills the
    required property. After, we find the signals for it $\sigma^i$. The first
    four elements are positive, because, $\partial_0$ has $C_0(K^i)$ as
    kernel. On the other hand $[0,1]$, $[1,2]$ and $[2,3]$ are negatives. At
    last $[3,0]$ is positive, because $[0,1] + [1,2] + [2,3] + [3,0]$ belongs
    to $Z_1(K^8)$. Now we can follow the algorithm thorough a table: 

    \begin{center}
        \begin{tabular}{ c|c|c|c|c|c|c|c|c}
         - & $\sigma^1$ & $\sigma^2$ & $\sigma^3$ & $\sigma^4$ & $\sigma^5$ &
         $\sigma^6$ & $\sigma^7$ &$\sigma^8$ \\ 
         \hline
         Signal & + & + & + & + & - & - & - & + \\  
         $\beta_0(K)$ & 1 & 2 & 3 & 4 & 3 & 2 & 1 & 1 \\ 
         $\beta_1(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\     
         $\beta_2(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\     

        \end{tabular}
    \end{center}

    \item  $K = \{[0], [1], [2], [3], [0, 1], [1, 2], [2, 3], [3, 0], [0, 2], [1, 3], [0, 1, 2], [0, 1, 3], [0, 2, 3], [1, 2, 3]\}.
    $
    
    First we determine the ordering to be as placed in the set. It fulfills
    the required property. After, we find the signals for it $\sigma^i$.  The vertices have positive signal. The following three edges cannot form any cycle, so they are negative. The last three edges are part of a cycle considering three other already placed of its dimension. When we achieve the simplices with dimension 2, the first three must be negative, because when we sum every combination of them, the boundary has image different from 0. The last, however will be positive.  
    Now we can follow the algorithm thorough a table: 

    \begin{center}
        \begin{tabular}{ c|c|c|c|c|c|c|c|c|c|c|c|c|c|c}
         - & $\sigma^1$ & $\sigma^2$ & $\sigma^3$ & $\sigma^4$ & $\sigma^5$ &
         $\sigma^6$ & $\sigma^7$ &$\sigma^8$ &$\sigma^9$ &$\sigma^{10}$
         &$\sigma^{11}$ &$\sigma^{12}$ &$\sigma^{13}$ &$\sigma^{14}$ \\ 
         \hline
         Signal & + & + & + & + & - & - & - & + & + & + & - & - & - & + \\  
         $\beta_0(K)$ & 1 & 2 & 3 & 4 & 3 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\ 
         $\beta_1(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 2 & 3 & 2 & 1 & 0 & 0 \\     
         $\beta_2(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\     

        \end{tabular}
    \end{center}

\end{enumerate}

The result corroborates with those found previously. 

\end{proof}

\noindent\linia

\begin{exercise}
    Prove that $\partial \Delta_n$ is a triangulation of the $(n -1)$-sphere
    $\sphere_{n-1} \subset \R^n$. 
\end{exercise}

\begin{proof}

It's clear that $\partial \Delta_n$ is a simplicial complex, because, for
every simplex $\sigma \in \partial \Delta_n$ and $\tau \subset \sigma$, $\tau
\in \Delta_n$ - since it's a simplicial complex - and $\tau \neq V$, then $\tau
\in \partial \Delta_n$. I shall prove that the topological realization of
$\Delta_n$, denoted as $B_n$, is homeomorphic to the $\sphere_{n-1}$. We can
describe it
$$
B_n = \{(\alpha_0, ..., \alpha_n) \in [0,1]^{n+1}, \sum_{i=0}^n \alpha_i = 1 \text{ and for some } i, \alpha_i = 0\}
$$
Let $H = \{(x_0, ..., x_n) \in \R^{n+1} | \sum_{i=0}^n x_i = 1\}$. It's clear
that $B_n \subset H$. Define $C_n := \partial \B(b,r) \cap H$ such that $C_n
\subset \text{interior } \Delta_n$. We'll show it's homeomorphic
to $B_n$. 

Let $b = \frac{1}{n+1}(1,...,1) \in \R^{n+1}$ and take $x \in C_n$. Consider
the half line which start in $b$ and crosses $x$. Its equation can be
described as $b + \alpha(x - b)$. It intersects $B_n$ when at least one of its
coordinates is zero and the other are between $0$ and $1$. The sum will be
always 1 because we are in $H$. Denote $x_{(m)} = \min\{x_i : i^{th}
\text{coordinate of } x\}$. Let's take $\alpha$ such that 
$$
b_{(m)} + \alpha(x_{(m)} - b_{(m)}) = 0 \implies \alpha = \frac{1}{1 - (n+1)x_{(m)}}
$$
For every other $i \neq (m)$, 
\begin{equation*}
    \begin{split}
        b_i + \alpha(x_i - b_i) &= \frac{1}{n+1}\left(1 + \frac{1}{1 - (n+1)x_{(m)}}(x_i(n+1) - 1)\right) \\
        &= \frac{1}{n+1}\left(1 - \frac{1}{1 - (n+1)x_{(m)}}(1 - x_i(n+1))\right) \\
        &= \frac{1}{n+1}\left((n+1)\frac{x_i - x_{m}}{1 - (n+1)x_{(m)}}\right) \\
        &= \frac{x_i - x_{m}}{1 - (n+1)x_{(m)}} \ge 0
    \end{split}
\end{equation*}
since $x_{(m)} < 1/(n+1)$. Note that $1 = \sum_{j=0}^m x_j \ge x_i + nx_{(m)}
\implies 1 - (n+1)x_{(m)} \ge x_i - x_m$ and we conclude that $b_i +
\alpha(x_i - b_i) \in [0,1]$, that is, $b - \alpha(x - b) \in B_n$. Denote
this map $f$. Let's prove it's a homeomorphism. 

\begin{enumerate}
    \item $f$ is injective: suppose not. In this case, there is some point $p
    \in B_n$ and two points $c_1, c_2 \in C_n$ such that there are two
    segments starting at $p$ and crossing $B_n$ at $p$, however it one passes
    thorough $c_1$ and $c_2$ respectively. So both segments have two points in
    common, what implies they are equal. Suppose, no loss of generality, that
    $c_1$ is between $p$ and $c_2$. Then $1 = ||c_2 - b|| < ||c_1 - b|| = 1$,
    a contradiction and $f$ is injective. 

    \item $f$ is surjective: Take $y$ from $B_n$ and make the half segment $b$ to $y$. It's clear
    it crosses $C_n$ because $p$ is in its interior.

    \item $f$ is continuos: First we note that the map $x \mapsto x_{(m)}$ is
    continuos. $\alpha$ can be seen as map from $B_n$ to $[1, + \infty)$. If
    we extend this map to a map $\alpha ' : \R^{n+1} \to \R$, we see that
    $\alpha '$ is continuous by composing continuous functions and its
    restriction $\alpha$ will be continuos as well. Using the composition
    property, we infer $f$ is continuos. 
    
    \item $f^{-1}$ is continuos: The inverse is quite similar. We consider $y
    \in B_n$ and the
    half line $b + \alpha(y - b)$. We map $y$ to the value such $||b +
    \alpha(y - b)||^2 = r^2$. We obtain, using the norm 2, 
    $$
    \alpha = \frac{r^2(n+1) -1}{(n+1)||y-b||}
    $$
    what is a continuous function of $y$. 

\end{enumerate}

Therefore $B_n$ and $C_n$ are homeomorphic by $f$. Now we must
prove that $C_n$ is homeomorphic to $\sphere_{n-1}$, because if this is true,
by transitivity, $B_n \simeq \sphere_{n-1}$. 

\end{proof}

\noindent\linia

\begin{exercise}
    Show that the algorithm stops after a finite number of steps.
\end{exercise}

\begin{proof}

Consider the algorithm

\begin{algorithm}[H]
    \SetAlgoLined
    \KwIn{a boundary matrix $\Delta$}
    \KwOut{a reduced matrix $\tilde{\Delta}$}
     \For(){$j \leftarrow 1$ to $n$}{
        \While(){$\exists i < j$ such that $\delta(i) = \delta(j)$}{
            add column $i$ to column $j$
        }
     }
     \caption{Reduction of the boundary matrix}
    \end{algorithm}

\begin{remark}
    I'd add a condition in the algorithm for undefined $\delta(i)$, that is,
    we should consider the values in the domain of $\delta$.
\end{remark}

I have to prove that for every $1 \le j \le n$, the \texttt{while} block stops
after a finite number of steps. That is, in a finite number of steps $\forall
i < j, \delta(i) \neq \delta(j)$. Fix $j$ and let's prove by induction. First
suppose $k = \delta(j-1) = \delta(j)$. That means $1 = \Delta_{k,j-1} =
\Delta_{k,j}$ and $\Delta_{s,j-1} = \Delta_{s,j}=0, s > k$. When we add
columns $j-1$ and $j$, we will have $\Delta_{k,j} = 0$ and for all $s > k,
\Delta(s, j) = 0$. Therefore $\delta(j) < \delta(j-1)$. Now, suppose that if for
some $l \le i < j, \delta(i) = \delta(j)$,  then we can
do $\delta(j) \neq \delta(i), l \le i < j$ in a finite sequence of steps. If $\delta(l-1) = \delta(j)$, with one step we obtain $\delta(j) <
\delta(l-1)$ and we can have two cases: if $\delta(i) = \delta(j)$, for some
$l \le i < j$ and by the
induction hypotheses, in a finite number os steps one can achieve the desired
property; or if $\delta(i) \neq \delta(j), l-1 \le i < j$. That case needs no
further internal step. In the limit we will have the case when $l=1$ and we
have finite steps to achieve there. We passed the case where $1 = \delta(j) =
\delta(i)$. In this case, $\delta(j)$ turns to be the 0-column and becomes
undefined. By the remark, we break the \texttt{while}. Since we have only
finite values for $j$, the algorithm ends in a finite number of steps. 

\end{proof}

\noindent\linia 

\begin{exercise}
    Apply Algorithm to solve Exercise 31.
\end{exercise}

\begin{proof}

So as to solve both exercises, the order will be as placed in the set for each
case.
After we build the boundary matrix and apply the Algorithm from the last
exercise to obtain the reduced matrix and with it, define $\sigma^i$ as negative
if $\delta(i)$ is defined and positive, otherwise. 

\begin{enumerate}
    \item    $K = \{[0], [1], [2], [3], [0, 1], [1, 2], [2, 3], [3, 0]\}.$
    
    This is the boundary matrix

    \begin{center}
        \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
        \hline
        -          & $\sigma_1$ & $\sigma_2$ & $\sigma_3$ & $\sigma_4$ & $\sigma_5$ & $\sigma_6$ & $\sigma_7$ & $\sigma_8$ \\ \hline
        $\sigma_1$ & 0          & 0          & 0          & 0          & 1          & 0          & 0          & 1          \\ \hline
        $\sigma_2$ & 0          & 0          & 0          & 0          & 1          & 1          & 0          & 0          \\ \hline
        $\sigma_3$ & 0          & 0          & 0          & 0          & 0          & 1          & 1          & 0          \\ \hline
        $\sigma_4$ & 0          & 0          & 0          & 0          & 0          & 0          & 1          & 1          \\ \hline
        $\sigma_5$ & 0          & 0          & 0          & 0          & 0          & 0          & 0          & 0          \\ \hline
        $\sigma_6$ & 0          & 0          & 0          & 0          & 0          & 0          & 0          & 0          \\ \hline
        $\sigma_7$ & 0          & 0          & 0          & 0          & 0          & 0          & 0          & 0          \\ \hline
        $\sigma_8$ & 0          & 0          & 0          & 0          & 0          & 0          & 0          & 0          \\ \hline
        \end{tabular}
    \end{center}

    When we apply the algorithm, we start in $i = 5$. However we do not enter
    the \texttt{while} block until $j = 8$ when $\delta(7) =
    \delta(8) = 4$. So we sum this columns, after $\sigma_6$ to $\sigma_8$ and
    at last $\sigma_5$ to $\sigma_8$. So $\sigma_8$ will be the 0-column,
    while the other remain unaltered. By this, we obtain the signals in order
    to calculate the Betti numbers. 

    \begin{center}
        \begin{tabular}{ c|c|c|c|c|c|c|c|c}
         - & $\sigma^1$ & $\sigma^2$ & $\sigma^3$ & $\sigma^4$ & $\sigma^5$ &
         $\sigma^6$ & $\sigma^7$ &$\sigma^8$ \\ 
         \hline
         Signal & + & + & + & + & - & - & - & + \\  
         $\beta_0(K)$ & 1 & 2 & 3 & 4 & 3 & 2 & 1 & 1 \\ 
         $\beta_1(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\     
         $\beta_2(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\     

        \end{tabular}
    \end{center}

    \item  $K = \{[0], [1], [2], [3], [0, 1], [1, 2], [2, 3], [3, 0], [0, 2], [1, 3], [0, 1, 2], [0, 1, 3], [0, 2, 3], [1, 2, 3]\}.
    $
    
    The boundary matrix is larger than the previous one. 

    \begin{center}
        \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
            \hline
            -             & $\sigma_{1,2,3,4}$ & $\sigma_5$ & $\sigma_6$ & $\sigma_7$ & $\sigma_8$ & $\sigma_9$ & $\sigma_{10}$ & $\sigma_{11}$ & $\sigma_{12}$ & $\sigma_{13}$ & $\sigma_{14}$ \\ \hline
            $\sigma_1$    & 0                  & 1          & 0          & 0          & 1          & 1          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_2$    & 0                  & 1          & 1          & 0          & 0          & 0          & 1             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_3$    & 0                  & 0          & 1          & 1          & 0          & 1          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_4$    & 0                  & 0          & 0          & 1          & 1          & 0          & 1             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_5$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 1             & 1             & 0             & 0             \\ \hline
            $\sigma_6$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 1             & 0             & 0             & 1             \\ \hline
            $\sigma_7$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 1             & 1             \\ \hline
            $\sigma_8$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 1             & 1             & 0             \\ \hline
            $\sigma_9$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 1             & 0             & 1             & 0             \\ \hline
            $\sigma_{10}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 1             & 0             & 1             \\ \hline
            $\sigma_{11}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_{12}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_{13}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_{14}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
        \end{tabular}
    \end{center}

    This matrix has several more things to deal. First we make the column
    $\sigma_8$ be a 0-column again. After we make the same to $\sigma_9$,
    being replaced by $\sigma_5 + \sigma_6 + \sigma_9$ and $\sigma_{10}$ by
    $\sigma_6 + \sigma_7 + \sigma_{10}$. We will have  

    \begin{center}
        \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
            \hline
            -             & $\sigma_{1,2,3,4}$ & $\sigma_5$ & $\sigma_6$ & $\sigma_7$ & $\sigma_8$ & $\sigma_9$ & $\sigma_{10}$ & $\sigma_{11}$ & $\sigma_{12}$ & $\sigma_{13}$ & $\sigma_{14}$ \\ \hline
            $\sigma_1$    & 0                  & 1          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_2$    & 0                  & 1          & 1          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_3$    & 0                  & 0          & 1          & 1          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_4$    & 0                  & 0          & 0          & 1          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_5$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 1             & 1             & 0             & 0             \\ \hline
            $\sigma_6$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 1             & 0             & 0             & 1             \\ \hline
            $\sigma_7$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 1             & 1             \\ \hline
            $\sigma_8$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 1             & 1             & 0             \\ \hline
            $\sigma_9$    & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 1             & 0             & 1             & 0             \\ \hline
            $\sigma_{10}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 1             & 0             & 1             \\ \hline
            $\sigma_{11}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_{12}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_{13}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
            $\sigma_{14}$ & 0                  & 0          & 0          & 0          & 0          & 0          & 0             & 0             & 0             & 0             & 0             \\ \hline
        \end{tabular}
    \end{center}

    The next column to deal is $\sigma_{13}$. Summing it with $\sigma_{11}$
    will solve the problem. With $\sigma_{14}$ we need to replace with
    $\sigma_{12} + \sigma_{13} \sigma_{14}$, considering the new
    $\sigma_{13}$. But this will turn $\sigma_{14}$ to be a 0-column. We know,
    then, the signals for each column. 

    \begin{center}
        \begin{tabular}{ c|c|c|c|c|c|c|c|c|c|c|c|c|c|c}
         - & $\sigma^1$ & $\sigma^2$ & $\sigma^3$ & $\sigma^4$ & $\sigma^5$ &
         $\sigma^6$ & $\sigma^7$ &$\sigma^8$ &$\sigma^9$ &$\sigma^{10}$
         &$\sigma^{11}$ &$\sigma^{12}$ &$\sigma^{13}$ &$\sigma^{14}$ \\ 
         \hline
         Signal & + & + & + & + & - & - & - & + & + & + & - & - & - & + \\  
         $\beta_0(K)$ & 1 & 2 & 3 & 4 & 3 & 2 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\ 
         $\beta_1(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 2 & 3 & 2 & 1 & 0 & 0 \\     
         $\beta_2(K)$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\     

        \end{tabular}
    \end{center}

\end{enumerate}

\end{proof}